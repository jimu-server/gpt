<?xml version="1.0" encoding="utf-8" ?>
<mapper namespace="GptMapper">
    <insert id ="CreateConversation">
        insert into app_chat_conversation(id, user_id, title)
        VALUES ({Id}, {UserId}, {Title});
    </insert>

    <delete id="DelConversation">
        delete
        from app_chat_conversation
        where user_id = {UserId}
          and id = {Id};
    </delete>

    <select id="ConversationList">
        select *
        from app_chat_conversation
        where user_id = {UserId}
        order by create_time;
    </select>

    <select id="ConversationHistory">
        select *
        from app_chat_message
        where user_id = {UserId}
          and conversation_id = {ConversationId}
        order by create_time
    </select>

    <update id ="UpdateConversationLastMsg">
        update app_chat_conversation
        set last_msg={LastMsg},
            last_model={LastModel},
            last_time={LastTime}
        where id = {Id}
    </update>

    <insert id="CreateMessage">
        insert into app_chat_message(id, conversation_id, user_id, role, content, create_time)
        VALUES ({Id}, {ConversationId}, {UserId}, {Role}, {Content}, {CreateTime})
    </insert>

    <select id="SelectMessageItem">
        select *
        from app_chat_message
        where id = {Id}
    </select>

</mapper>